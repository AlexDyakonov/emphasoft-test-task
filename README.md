# emphasoft-test-task

## Приложение для бронирования комнат в отеле

### Требования:

- Для комнат должны быть поля: номер/название, стоимость за сутки, количество мест.
- Пользователи должны уметь фильтровать и сортировать комнаты по цене, по количеству мест.
- Пользователи должны уметь искать свободные комнаты в заданном временном интервале.
- Пользователи должны уметь забронировать свободную комнату.
- Суперюзер должен уметь добавлять/удалять/редактировать комнаты и редактировать записи о бронях через админ панель Django.
- Брони могут быть отменены как самим юзером, так и суперюзером.
- Пользователи должны уметь регистрироваться и авторизовываться (логиниться).
- Чтобы забронировать комнату пользователи должны быть авторизованными. Просматривать комнаты можно без логина. Авторизованные пользователи должны видеть свои брони.

### Запуск приложения

**Желательно использовать UNIX систему. Не люблю винду и не люблю под неё переписывать докерфайлы.**

Для начала копируем репозиторий:
```
git clone https://github.com/AlexDyakonov/emphasoft-test-task
```

Меняем ветку на `dev`:
```
cd emphasoft-test-task
git checkout dev
```
Теперь перейдем в каталог с кодом:
```
cd backend
```
И создадим (или скопируем `.env` файл с параметрами запуска):
```
cp .env.example .env
```
**ВАЖНО!** При запуске в прод режиме надо менять порты на нестандартные и избегать использования простых паролей (у постгреса как минимум). У меня на проекте с помощью дыры смогли выбраться из контейнера постгреса и поставили майнер на сервер. [Вот статья, если интересно, то почитайте (в комментах то, как попал майнер).](https://habr.com/ru/articles/582830/)

С помощью `docker-compose` билдим и запускаем:
```
docker-compose up --build
```
Можно дополнительно указать флаг `-d` для запуска демоном, но потом для просмотра логов надо прописать:
```
docker-compose logs -f
```

А пока создадим суперпользователя:
```
docker exec -it backend bash
python manage.py createsuperuser
```
Модель пользователей никак не изменял. Изменял авторизацию на OAuth2 с помощью токенов. 
После создания суперпользователя можно использовать админ панель. 
Минимальную документацию по апи можно посмотреть в [сваггере](http://0.0.0.0/api/swagger/), а админку [тут](http://0.0.0.0/api/admin/).

Всю статику отдает nginx на порту 80. Ссл локально не запустить, но я использую `certbot`. 

**P.S**
Для ревьюера: Говорю сразу, что раньше автотесты делал один раз (в самом первом проекте), в других проектах проверял только на сборку. Работаю в VSCode, там настроил автоформатирование с помощью `Prettier`. Документация к АПИ есть, к коду не делал, думаю, его можно обсудить, если что. Аннотации типов в django делать не привык, но иногда пользуюсь, если не очевидно или неудобно без них. Буду рад услышать фидбек!